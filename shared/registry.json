{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Central registry configuration for all nodes. This is the single source of truth for both C# and TypeScript execution systems. Tools are handled separately (manually registered in nodeRegistry.ts). API integrations are stored separately in shared/apiIntegrations/ directory.",
  "version": "2.0.0",
  "nodes": [
    {
      "type": "start",
      "name": "Start",
      "icon": "üöÄ",
      "description": "Entry point for external tools (Webhook, API, etc.)",
      "category": "core",
      "animationSpeed": "fast",
      "csharpProcessor": "StartNodeProcessor",
      "typescriptProcessor": "./nodes/registerBuiltIns#start",
      "inputSchema": {
        "type": "object",
        "description": "Input schema is optional and can be customized per workflow. If not defined, any input is accepted.",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "entryType": { "type": "string", "description": "Type of entry: webhook, schedule, or manual" },
          "method": { "type": "string", "description": "HTTP method used" },
          "input": { "description": "The original input data" },
          "message": { "type": "string", "description": "Workflow start message" },
          "label": { "type": "string", "description": "Node label" },
          "description": { "type": "string", "description": "Node description" }
        },
        "required": ["entryType", "method", "input", "message"]
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": false,
        "isUnique": true,
        "canDuplicate": false,
        "hasInput": false,
        "hasOutput": true,
        "configFormComponent": "StartNodeConfigForm"
      }
    },
    {
      "type": "end",
      "name": "End",
      "icon": "‚¨ú",
      "description": "Workflow exit point",
      "category": "core",
      "animationSpeed": "fast",
      "csharpProcessor": "EndNodeProcessor",
      "typescriptProcessor": "./nodes/registerBuiltIns#end",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any input from previous nodes",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "description": "End node returns the input as output (workflow result)",
        "additionalProperties": true
      },
      "frontend": {
        "hasConfigForm": false,
        "hasInput": true,
        "hasOutput": false
      }
    },
    {
      "type": "transform",
      "name": "Transform",
      "icon": "üîÑ",
      "description": "Transform or extract data from previous nodes",
      "category": "core",
      "animationSpeed": "fast",
      "csharpProcessor": "TransformNodeProcessor",
      "typescriptProcessor": "./nodes/registerBuiltIns#transform",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any input from previous nodes",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "description": "Output depends on transformation mode",
        "additionalProperties": true
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": false,
        "isUnique": false,
        "canDuplicate": true,
        "hasInput": true,
        "hasOutput": true,
        "configFormComponent": "TransformNodeConfigForm"
      }
    },
    {
      "type": "agent",
      "name": "Agent",
      "icon": "üë§",
      "description": "Define instructions, tools, and model configuration",
      "category": "ai",
      "animationSpeed": "slow",
      "csharpProcessor": "AgentNodeProcessor",
      "typescriptProcessor": "./nodes/registerBuiltIns#agent",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any input. Typically a string prompt or structured data.",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "output": {
            "description": "The agent's response/output",
            "oneOf": [
              { "type": "string" },
              { "type": "object" },
              { "type": "array" }
            ]
          },
          "trace": {
            "type": "array",
            "description": "Execution trace with tool calls and reasoning steps",
            "items": { "type": "object" }
          },
          "usage": {
            "type": "object",
            "description": "Token usage information",
            "properties": {
              "prompt_tokens": { "type": "number" },
              "completion_tokens": { "type": "number" },
              "total_tokens": { "type": "number" }
            }
          }
        },
        "required": ["output"]
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": false,
        "configFormComponent": null,
        "fields": {
          "agentName": {
            "type": "text",
            "placeholder": "Enter agent name"
          },
          "systemPrompt": {
            "type": "expression",
            "multiline": true,
            "rows": 4,
            "placeholder": "Enter instructions for the agent. Use {{variables}} for dynamic content"
          },
          "userPrompt": {
            "type": "expression",
            "multiline": true,
            "rows": 3,
            "placeholder": "Define the user message that will be sent to the agent. Use {{input.userPrompt}} or {{steps.nodeId.json}} for dynamic content"
          }
        }
      },
      "note": "Agent nodes are processed specially - C# delegates to execution-service"
    },
    {
      "type": "llm",
      "name": "LLM",
      "icon": "ü§ñ",
      "description": "Call OpenAI GPT models (GPT-4, GPT-3.5)",
      "category": "ai",
      "animationSpeed": "slow",
      "csharpProcessor": "LLMNodeProcessor",
      "typescriptProcessor": "./nodes/registerBuiltIns#llm",
      "inputSchema": {
        "type": "object",
        "description": "Accepts string prompts or structured data. Variables like {{steps.nodeId.data}} are resolved.",
        "oneOf": [
          { "type": "string" },
          { "type": "object", "additionalProperties": true }
        ]
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "response": {
            "type": "string",
            "description": "The LLM's text response"
          },
          "model": {
            "type": "string",
            "description": "The model used for generation"
          },
          "usage": {
            "type": "object",
            "description": "Token usage information",
            "properties": {
              "prompt_tokens": { "type": "number" },
              "completion_tokens": { "type": "number" },
              "total_tokens": { "type": "number" }
            }
          },
          "finish_reason": {
            "type": "string",
            "description": "Reason why generation stopped",
            "enum": ["stop", "length", "content_filter", "tool_calls"]
          }
        },
        "required": ["response"]
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": false,
        "fields": {
          "label": {
            "type": "text",
            "placeholder": "LLM Name"
          },
          "prompt": {
            "type": "expression",
            "multiline": true,
            "rows": 6,
            "placeholder": "Enter prompt... Use {{variables}} for dynamic content"
          },
          "model": {
            "type": "select",
            "options": [
              { "value": "gpt-4", "label": "GPT-4" },
              { "value": "gpt-3.5-turbo", "label": "GPT-3.5 Turbo" },
              { "value": "gpt-4-turbo", "label": "GPT-4 Turbo" },
              { "value": "claude-3", "label": "Claude 3" }
            ]
          },
          "temperature": {
            "type": "number",
            "min": 0,
            "max": 2,
            "step": 0.1
          }
        }
      }
    },
    {
      "type": "email",
      "name": "Email",
      "icon": "üìß",
      "description": "Send email via SMTP",
      "category": "integration",
      "animationSpeed": "slow",
      "csharpProcessor": "EmailNodeProcessor",
      "typescriptProcessor": "./nodes/registerBuiltIns#email",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any input. Email fields can use expressions like {{steps.nodeId.data}}",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": { "type": "boolean", "description": "Whether the email was sent successfully" },
          "messageId": { "type": "string", "description": "Unique message ID" },
          "message": { "type": "string", "description": "Status message" }
        },
        "required": ["success"]
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": true,
        "isUnique": false,
        "canDuplicate": true,
        "hasInput": true,
        "hasOutput": true,
        "fields": {
          "label": { "type": "text", "placeholder": "Email Node Name" },
          "fromEmail": { "type": "expression", "placeholder": "sender@example.com or {{steps.start.data.email}}", "required": true },
          "to": { "type": "expression", "placeholder": "recipient@example.com or {{steps.start.data.email}}", "required": true },
          "cc": { "type": "expression", "placeholder": "cc@example.com (optional)" },
          "bcc": { "type": "expression", "placeholder": "bcc@example.com (optional)" },
          "subject": { "type": "expression", "placeholder": "Email subject or {{steps.agent.data}}", "required": true },
          "emailFormat": { "type": "select", "options": [{ "value": "text", "label": "Text" }, { "value": "html", "label": "HTML" }, { "value": "both", "label": "Both" }], "default": "html" },
          "text": { "type": "expression", "multiline": true, "rows": 8, "placeholder": "Plain text message or {{steps.agent.data}}", "displayCondition": { "field": "emailFormat", "operator": "in", "value": ["text", "both"] } },
          "html": { "type": "expression", "multiline": true, "rows": 8, "placeholder": "HTML message or {{steps.agent.data}}", "displayCondition": { "field": "emailFormat", "operator": "in", "value": ["html", "both"] } },
          "smtpProfileSecret": { "type": "smtpProfile", "placeholder": "Select or create an SMTP profile" },
          "smtpHost": { "type": "expression", "placeholder": "smtp.gmail.com or {{steps.start.data.smtpHost}}", "displayCondition": { "field": "smtpProfileSecret", "operator": "equals", "value": "" } },
          "smtpPort": { "type": "number", "default": "587", "placeholder": "587", "displayCondition": { "field": "smtpProfileSecret", "operator": "equals", "value": "" } },
          "smtpUsername": { "type": "expression", "placeholder": "your-email@gmail.com or {{steps.start.data.smtpUsername}}", "displayCondition": { "field": "smtpProfileSecret", "operator": "equals", "value": "" } },
          "smtpPassword": { "type": "expression", "placeholder": "your-password or {{steps.start.data.smtpPassword}}", "displayCondition": { "field": "smtpProfileSecret", "operator": "equals", "value": "" } },
          "smtpHostSecret": { "type": "secret", "secretType": "Generic", "placeholder": "Legacy: Select SMTP Host secret (optional)", "hideWhenEmpty": true },
          "smtpUsernameSecret": { "type": "secret", "secretType": "Generic", "placeholder": "Legacy: Select SMTP Username secret (optional)", "hideWhenEmpty": true },
          "smtpPasswordSecret": { "type": "secret", "secretType": "Password", "placeholder": "Legacy: Select SMTP Password secret (optional)", "hideWhenEmpty": true },
          "fromNameSecret": { "type": "secret", "secretType": "Generic", "placeholder": "Select From Name secret (optional)" }
        }
      }
    },
    {
      "type": "http-request",
      "name": "HTTP Request",
      "icon": "üåê",
      "description": "Send HTTP request to external URL (useful for testing scheduled workflows)",
      "category": "integration",
      "animationSpeed": "slow",
      "csharpProcessor": "HttpRequestNodeProcessor",
      "typescriptProcessor": "./nodes/registerBuiltIns#http-request",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any data. If sendInput is true, this data is sent as request body.",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "status": {
            "type": "number",
            "description": "HTTP status code (200, 404, 500, etc.)"
          },
          "statusText": {
            "type": "string",
            "description": "HTTP status text (OK, Not Found, etc.)"
          },
          "data": {
            "description": "Response body (parsed JSON if possible, otherwise string)"
          },
          "headers": {
            "type": "object",
            "description": "Response headers",
            "additionalProperties": { "type": "string" }
          },
          "url": {
            "type": "string",
            "description": "The URL that was called"
          },
          "method": {
            "type": "string",
            "description": "HTTP method used",
            "enum": ["GET", "POST", "PUT", "DELETE", "PATCH"]
          }
        },
        "required": ["status", "data"]
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": true,
        "fields": {
          "label": {
            "type": "text",
            "placeholder": "HTTP Request Name"
          },
          "url": {
            "type": "expression",
            "placeholder": "https://webhook.site/your-unique-url or {{steps.agent-1.output}}"
          },
          "method": {
            "type": "select",
            "options": [
              { "value": "GET", "label": "GET" },
              { "value": "POST", "label": "POST" },
              { "value": "PUT", "label": "PUT" },
              { "value": "DELETE", "label": "DELETE" },
              { "value": "PATCH", "label": "PATCH" }
            ]
          },
          "sendInput": {
            "type": "select",
            "options": [
              { "value": "true", "label": "Yes" },
              { "value": "false", "label": "No" }
            ]
          },
          "headers": {
            "type": "expression",
            "multiline": true,
            "rows": 4,
            "placeholder": "{\"Content-Type\": \"application/json\", \"Authorization\": \"Bearer {{secrets.TOKEN}}\"} or leave empty for auto-generation"
          },
          "body": {
            "type": "expression",
            "multiline": true,
            "rows": 4,
            "placeholder": "Custom request body (JSON or text) or {{steps.agent-1.output}}"
          }
        }
      }
    },
      {
      "type": "delay",
      "name": "Delay",
      "icon": "‚è±Ô∏è",
      "description": "Wait for a specified amount of time before continuing",
      "category": "utility",
      "animationSpeed": "slow",
      "typescriptProcessor": "./nodes/registerBuiltIns#delay",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any input. The input will be passed through after the delay.",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "description": "Returns the input data unchanged after the delay",
        "additionalProperties": true
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": true,
        "isUnique": false,
        "canDuplicate": true,
        "hasInput": true,
        "hasOutput": true,
        "fields": {
          "label": {
            "type": "text",
            "placeholder": "Delay Node Name"
          },
          "delaySeconds": {
            "type": "number",
            "placeholder": "Delay in seconds",
            "default": 1,
            "min": 0,
            "max": 3600,
            "required": true
          }
        }
      }
    },
    {
      "type": "while",
      "name": "While Loop",
      "icon": "üîÑ",
      "description": "Execute a block of nodes repeatedly while a condition is true",
      "category": "logic",
      "animationSpeed": "slow",
      "csharpProcessor": "WhileNodeProcessor",
      "typescriptProcessor": "./nodes/registerBuiltIns#while",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any input. The condition is evaluated on each iteration.",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "iterations": { "type": "number", "description": "Number of loop iterations executed" },
          "finalOutput": { "description": "Output from the last iteration" },
          "exitedEarly": { "type": "boolean", "description": "Whether loop exited due to max iterations" }
        }
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": true,
        "hasInput": true,
        "hasOutput": true,
        "fields": {
          "label": {
            "type": "text",
            "placeholder": "While Loop Name"
          },
          "condition": {
            "type": "expression",
            "multiline": false,
            "placeholder": "Enter condition (e.g., {{steps.nodeId.count}} < 10)",
            "required": true
          },
          "maxIterations": {
            "type": "number",
            "placeholder": "Maximum iterations (safety limit)",
            "default": 100,
            "min": 1,
            "max": 10000,
            "required": true
          }
        }
      }
    },
    {
      "type": "foreach",
      "name": "For Each",
      "icon": "üîÅ",
      "description": "Iterate over an array and execute a block of nodes for each item",
      "category": "logic",
      "animationSpeed": "slow",
      "csharpProcessor": "ForEachNodeProcessor",
      "typescriptProcessor": "./nodes/registerBuiltIns#foreach",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any input. The arrayPath specifies which array to iterate over.",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "iterations": { "type": "number", "description": "Number of iterations executed" },
          "results": { "type": "array", "description": "Array of outputs from each iteration" },
          "finalOutput": { "description": "Output from the last iteration" }
        }
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": true,
        "hasInput": true,
        "hasOutput": true,
        "fields": {
          "label": {
            "type": "text",
            "placeholder": "For Each Name"
          },
          "arrayPath": {
            "type": "expression",
            "multiline": false,
            "placeholder": "Enter array path (e.g., {{steps.nodeId.data}} or {{steps.nodeId.json.data}})",
            "required": true
          }
        }
      }
    },
    {
      "type": "loop",
      "name": "Loop",
      "icon": "üîÅ",
      "description": "Start of a loop block (container for loop body)",
      "category": "logic",
      "animationSpeed": "slow",
      "typescriptProcessor": "./nodes/registerBuiltIns#loop",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any input. Loop type determines iteration behavior.",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "iterations": { "type": "number", "description": "Number of loop iterations executed" },
          "finalOutput": { "description": "Output from the last iteration" }
        }
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": true,
        "hasInput": true,
        "hasOutput": true,
        "fields": {
          "label": {
            "type": "text",
            "placeholder": "Loop Name"
          },
          "loopType": {
            "type": "select",
            "options": [
              { "value": "while", "label": "While Loop (condition-based)" },
              { "value": "foreach", "label": "For Each (array iteration)" }
            ],
            "default": "while",
            "required": true
          },
          "condition": {
            "type": "expression",
            "multiline": false,
            "placeholder": "Enter condition (e.g., {{steps.nodeId.count}} < 10)",
            "required": true,
            "displayCondition": {
              "field": "loopType",
              "operator": "equals",
              "value": "while"
            }
          },
          "arrayPath": {
            "type": "expression",
            "multiline": false,
            "placeholder": "Enter array path (e.g., {{steps.nodeId.data}} or {{steps.nodeId.json.items}})",
            "required": true,
            "displayCondition": {
              "field": "loopType",
              "operator": "equals",
              "value": "foreach"
            }
          },
          "maxIterations": {
            "type": "number",
            "placeholder": "Maximum iterations (safety limit)",
            "default": 100,
            "min": 1,
            "max": 10000,
            "required": true
          }
        }
      }
    },
    {
      "type": "end-loop",
      "name": "End Loop",
      "icon": "üîö",
      "description": "End of a loop block (paired with Loop node)",
      "category": "logic",
      "animationSpeed": "fast",
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": true,
        "hasInput": true,
        "hasOutput": true,
        "fields": {
          "label": {
            "type": "text",
            "placeholder": "End Loop"
          }
        }
      }
    },
    {
      "type": "ifelse",
      "name": "If / Else",
      "icon": "‚ÜóÔ∏è",
      "description": "Execute different paths based on a condition",
      "category": "logic",
      "animationSpeed": "fast",
      "csharpProcessor": "IfElseNodeProcessor",
      "typescriptProcessor": "./nodes/registerBuiltIns#ifelse",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any input. The condition is evaluated to determine which branch to execute.",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "condition": { "type": "string", "description": "The evaluated condition" },
          "result": { "type": "boolean", "description": "Whether the condition was true or false" },
          "output": { "description": "Output from the executed branch" }
        }
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": true,
        "hasInput": true,
        "hasOutput": false,
        "fields": {
          "label": {
            "type": "text",
            "placeholder": "If / Else Name"
          },
          "condition": {
            "type": "expression",
            "multiline": false,
            "placeholder": "Enter condition (e.g., {{loop.current.id}} === 5)",
            "required": true
          }
        }
      }
    },
    {
      "type": "code",
      "name": "Code",
      "icon": "üíª",
      "description": "Execute custom JavaScript code to transform data",
      "category": "core",
      "animationSpeed": "fast",
      "typescriptProcessor": "./nodes/registerBuiltIns#code",
      "inputSchema": {
        "type": "object",
        "description": "Accepts any input from previous nodes. Access via $input, $json, $steps, $secrets in code.",
        "additionalProperties": true
      },
      "outputSchema": {
        "type": "object",
        "description": "Output depends on the code execution result",
        "additionalProperties": true
      },
      "frontend": {
        "hasConfigForm": true,
        "useAutoConfigForm": false,
        "isUnique": false,
        "canDuplicate": true,
        "hasInput": true,
        "hasOutput": true,
        "configFormComponent": "CodeNodeConfigForm",
        "fields": {
          "label": {
            "type": "text",
            "placeholder": "Code Node Name"
          },
          "code": {
            "type": "expression",
            "multiline": true,
            "rows": 15,
            "placeholder": "// Write your JavaScript code here\n// Access input data from previous nodes using variables\n// Example: const data = {{steps.start.json}};\n\n// Your code here\nreturn data;"
          }
        }
      },
      "note": "Code Node uses custom CodeNodeConfigForm with CodeMirror editor. Processor is implemented in registerBuiltIns.ts (outside AUTO-GENERATED section)."
    }
  ]
}
